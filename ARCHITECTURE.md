# Архитектура проекта - Feature-Sliced Design

## Визуальная схема слоёв

```
┌─────────────────────────────────────────────────────────────┐
│                        APP LAYER                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  pages, routing, providers, initialization          │   │
│  │  - layout.tsx                                        │   │
│  │  - page.tsx                                          │   │
│  │  - dashboard/page.tsx                                │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                           ↓ импортирует
┌─────────────────────────────────────────────────────────────┐
│                      WIDGETS LAYER                          │
│  ┌──────────────────┐ ┌──────────────┐ ┌──────────────┐   │
│  │   AppSidebar     │ │    Chat      │ │SettingsPanel │   │
│  │  (композитный    │ │ (композитный │ │ (композитный │   │
│  │   блок навигации)│ │  блок чата)  │ │ блок настроек│   │
│  └──────────────────┘ └──────────────┘ └──────────────┘   │
└─────────────────────────────────────────────────────────────┘
                           ↓ импортирует
┌─────────────────────────────────────────────────────────────┐
│                     FEATURES LAYER                          │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────────┐   │
│  │ ChatMessage  │ │TeamSwitcher  │ │  UserDropdown    │   │
│  │ (сообщение)  │ │(переключатель│ │ (меню пользов.)  │   │
│  └──────────────┘ └──────────────┘ └──────────────────┘   │
│                    ┌──────────────┐                        │
│                    │SliderControl │                        │
│                    │  (контрол)   │                        │
│                    └──────────────┘                        │
└─────────────────────────────────────────────────────────────┘
                           ↓ импортирует
┌─────────────────────────────────────────────────────────────┐
│                    ENTITIES LAYER                           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Бизнес-сущности (готово для расширения)            │   │
│  │  - User                                              │   │
│  │  - Message                                           │   │
│  │  - Team                                              │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                           ↓ импортирует
┌─────────────────────────────────────────────────────────────┐
│                      SHARED LAYER                           │
│  ┌───────────────┐ ┌──────────┐ ┌──────────┐              │
│  │      UI       │ │   LIB    │ │  HOOKS   │              │
│  │  (компоненты) │ │ (utils)  │ │ (хуки)   │              │
│  │  - Button     │ │ - cn()   │ │-useMobile│              │
│  │  - Input      │ │          │ │-useSlider│              │
│  │  - Dialog     │ │          │ │          │              │
│  │  - ...        │ │          │ │          │              │
│  └───────────────┘ └──────────┘ └──────────┘              │
└─────────────────────────────────────────────────────────────┘
```

## Схема зависимостей

```
┌──────┐
│ APP  │────┐
└──────┘    │
            ↓
      ┌──────────┐
      │ WIDGETS  │────┐
      └──────────┘    │
                      ↓
                ┌──────────┐
                │ FEATURES │────┐
                └──────────┘    │
                                ↓
                          ┌──────────┐
                          │ ENTITIES │────┐
                          └──────────┘    │
                                          ↓
                                    ┌──────────┐
                                    │  SHARED  │
                                    └──────────┘
```

## Пример композиции компонентов (Dashboard page)

```
┌────────────────────────────────────────────────────┐
│              Dashboard Page (app)                  │
│  ┌──────────────────────────────────────────────┐ │
│  │         SidebarProvider                      │ │
│  │  ┌─────────────┐  ┌──────────────────────┐  │ │
│  │  │ AppSidebar  │  │   SidebarInset       │  │ │
│  │  │  (widget)   │  │  ┌────────────────┐  │  │ │
│  │  │             │  │  │    Header      │  │  │ │
│  │  │ ┌─────────┐ │  │  │ ┌──────────┐  │  │  │ │
│  │  │ │  Team   │ │  │  │ │UserDropdo│  │  │  │ │
│  │  │ │Switcher │ │  │  │ │wn(feature│  │  │  │ │
│  │  │ │(feature)│ │  │  │ └──────────┘  │  │  │ │
│  │  │ └─────────┘ │  │  └────────────────┘  │  │ │
│  │  │             │  │                      │  │ │
│  │  │ [Nav Menu]  │  │  ┌────────────────┐  │  │ │
│  │  │ - Chat      │  │  │SettingsPanelPr│  │  │ │
│  │  │ - Real-time │  │  │ovider         │  │  │ │
│  │  │ - ...       │  │  │ ┌──────────┐  │  │  │ │
│  │  │             │  │  │ │   Chat   │  │  │  │ │
│  │  └─────────────┘  │  │ │ (widget) │  │  │  │ │
│  │                    │  │ │          │  │  │  │ │
│  │                    │  │ │ ┌──────┐ │  │  │  │ │
│  │                    │  │ │ │ Chat │ │  │  │  │ │
│  │                    │  │ │ │Messag│ │  │  │  │ │
│  │                    │  │ │ │e     │ │  │  │  │ │
│  │                    │  │ │ │(feat)│ │  │  │  │ │
│  │                    │  │ │ └──────┘ │  │  │  │ │
│  │                    │  │ │          │  │  │  │ │
│  │                    │  │ └──────────┘  │  │  │ │
│  │                    │  │               │  │  │ │
│  │                    │  │ ┌──────────┐  │  │  │ │
│  │                    │  │ │ Settings │  │  │  │ │
│  │                    │  │ │  Panel   │  │  │  │ │
│  │                    │  │ │ (widget) │  │  │  │ │
│  │                    │  │ │          │  │  │  │ │
│  │                    │  │ │ ┌──────┐ │  │  │  │ │
│  │                    │  │ │ │Slider│ │  │  │  │ │
│  │                    │  │ │ │Contro│ │  │  │  │ │
│  │                    │  │ │ │l     │ │  │  │  │ │
│  │                    │  │ │ │(feat)│ │  │  │  │ │
│  │                    │  │ │ └──────┘ │  │  │  │ │
│  │                    │  │ └──────────┘  │  │  │ │
│  │                    │  └────────────────┘  │  │ │
│  │                    └──────────────────────┘  │ │
│  └──────────────────────────────────────────────┘ │
└────────────────────────────────────────────────────┘
```

## Правила импортов

### ✅ Разрешено

```typescript
// app → widgets
import { Chat } from "@/widgets/chat";

// widgets → features
import { ChatMessage } from "@/features/chat-message";

// features → entities
import { useUser } from "@/entities/user";

// entities → shared
import { Button } from "@/shared/ui";

// любой → shared
import { cn } from "@/shared/lib";
```

### ❌ Запрещено

```typescript
// widgets → widgets
import { Chat } from "@/widgets/chat"; // в другом widget

// features → features
import { ChatMessage } from "@/features/chat-message"; // в другой feature

// shared → features
import { ChatMessage } from "@/features/chat-message"; // в shared

// нижележащий → вышележащий
import { Chat } from "@/widgets/chat"; // в shared
```

## Структура модуля

Каждый модуль в features/widgets/entities имеет следующую структуру:

```
feature-name/
├── ui/                    # UI компоненты
│   └── feature-name.tsx
├── model/                 # Бизнес-логика (опционально)
│   ├── types.ts
│   ├── hooks.ts
│   └── utils.ts
├── api/                   # API запросы (опционально)
│   └── api.ts
└── index.ts               # Public API
```

## Пример Public API

```typescript
// src/features/chat-message/index.ts
export { ChatMessage } from "./ui/chat-message";
export type { ChatMessageProps } from "./ui/chat-message";

// Использование
import { ChatMessage } from "@/features/chat-message";
```

## Преимущества этой архитектуры

1. **Предсказуемость** - всегда понятно, где искать код
2. **Изоляция** - изменения в одном модуле не влияют на другие
3. **Повторное использование** - shared слой доступен везде
4. **Тестируемость** - каждый модуль можно тестировать отдельно
5. **Онбординг** - новые разработчики быстро понимают структуру
6. **Масштабируемость** - легко добавлять новые фичи
